<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Filter Tool | Apply Professional Filters to Videos | Factictionary</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Free online video filter tool. Apply professional video filters including brightness, contrast, saturation, sepia, vintage, and cinematic effects. Works entirely in your browser with 100% privacy protection.">
    <meta name="keywords" content="video filter, video effects, video editor, brightness, contrast, saturation, sepia, vintage, cinematic, video processing, online video tool">
    <meta name="author" content="Factictionary Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Video Filter Tool | Apply Professional Filters to Videos | Factictionary">
    <meta property="og:description" content="Professional video filtering tool with real-time preview. Apply brightness, contrast, saturation, vintage, and cinematic effects. Free and privacy-protected.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://factictionary.github.io/tools/video_filter.html">
    <meta property="og:image" content="https://factictionary.github.io/assets/images/modern_educational_platform_hero_illustration.jpg">
    
    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Video Filter Tool | Factictionary">
    <meta name="twitter:description" content="Apply professional video filters with real-time preview. Free and privacy-protected.">
    <meta name="twitter:image" content="https://factictionary.github.io/assets/images/modern_educational_platform_hero_illustration.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://factictionary.github.io/tools/video_filter.html">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/style.css">
    
    <!-- FFmpeg.wasm Library -->
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.12.10/dist/umd/ffmpeg.js"></script>
    <script src="https://unpkg.com/@ffmpeg/util@0.12.1/dist/umd/index.js"></script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Factictionary Video Filter",
        "description": "Free online video filter tool to apply professional video effects including brightness, contrast, saturation, and more.",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "provider": {
            "@type": "Organization",
            "name": "Factictionary"
        }
    }
    </script>
</head>
<body>
    <!-- Skip to main content -->
    <a href="#main" class="skip-link">Skip to main content</a>
    
    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <a href="/" class="logo">Factictionary</a>
            
            <ul class="nav-links">
                <li><a href="/blog/" class="nav-link">Blog</a></li>
                <li><a href="/tools/" class="nav-link active">Tools</a></li>
                <li><a href="/about.html" class="nav-link">About</a></li>
                <li><a href="/contact.html" class="nav-link">Contact</a></li>
            </ul>
            
            <div class="nav-cta">
                <a href="/blog/" class="btn btn-primary">Read Articles</a>
            </div>
            
            <button class="menu-toggle" aria-label="Toggle mobile menu" aria-expanded="false">
                <span>‚ò∞</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main">
        <!-- AdSense Container -->
        <div class="ad-container top-ad">
            <!-- AdSense code will be inserted here -->
        </div>

        <!-- Tool Header -->
        <header class="tool-header">
            <div class="container">
                <div class="tool-header-content">
                    <h3 class="tool-title">Video Filter Tool</h3>
                    <p class="tool-subtitle">Apply professional video filters and effects to your videos with real-time preview. Adjust brightness, contrast, saturation, and more with our advanced video processing tool.</p>
                    <div class="privacy-badge">üîí 100% Privacy Protected</div>
                    <div class="tool-features">
                        <span class="feature-tag">Real-time Preview</span>
                        <span class="feature-tag">Brightness Control</span>
                        <span class="feature-tag">Contrast Adjuster</span>
                        <span class="feature-tag">Saturation Filter</span>
                        <span class="feature-tag">Vintage Effects</span>
                        <span class="feature-tag">Cinematic Styles</span>
                        <span class="feature-tag">Before/After View</span>
                        <span class="feature-tag">Download Filtered</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tool Workspace -->
        <section class="tool-workspace">
            <div class="container">
                <!-- Video Upload Section -->
                <div class="input-section">
                    <label class="input-label">Upload Your Video</label>
                    <div id="videoUpload" class="video-upload-area" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragenter="handleDragEnter(event)" ondragleave="handleDragLeave(event)">
                        <div class="upload-content">
                            <div class="upload-icon">üìπ</div>
                            <h3>Drop your video file here</h3>
                            <p>or click to browse</p>
                            <input type="file" id="videoFileInput" accept="video/*" style="display: none;" onchange="handleFileSelect(event)">
                            <button class="btn btn-secondary" onclick="document.getElementById('videoFileInput').click()">Choose Video File</button>
                        </div>
                    </div>
                    <div id="uploadHelp" class="input-help">
                        Supported formats: MP4, WebM, AVI, MOV, WMV. Maximum file size: 500MB. Your video is processed locally and never uploaded to our servers.
                    </div>
                    <div id="fileInfo" class="file-info" style="display: none;"></div>
                </div>

                <!-- Filter Controls -->
                <div class="filter-section" id="filterSection" style="display: none;">
                    <h3 class="section-title">Filter Controls</h3>
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label for="brightnessRange" class="filter-label">üåû Brightness: <span id="brightnessValue">0</span>%</label>
                            <input type="range" id="brightnessRange" class="filter-slider" min="-100" max="100" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="contrastRange" class="filter-label">‚ö° Contrast: <span id="contrastValue">0</span>%</label>
                            <input type="range" id="contrastRange" class="filter-slider" min="-100" max="100" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="saturationRange" class="filter-label">üåà Saturation: <span id="saturationValue">0</span>%</label>
                            <input type="range" id="saturationRange" class="filter-slider" min="-100" max="100" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="hueRange" class="filter-label">üé® Hue: <span id="hueValue">0</span>¬∞</label>
                            <input type="range" id="hueRange" class="filter-slider" min="-180" max="180" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="sepiaRange" class="filter-label">üìú Sepia: <span id="sepiaValue">0</span>%</label>
                            <input type="range" id="sepiaRange" class="filter-slider" min="0" max="100" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="grayscaleRange" class="filter-label">‚ö´ Grayscale: <span id="grayscaleValue">0</span>%</label>
                            <input type="range" id="grayscaleRange" class="filter-slider" min="0" max="100" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="blurRange" class="filter-label">‚ú® Blur: <span id="blurValue">0</span>px</label>
                            <input type="range" id="blurRange" class="filter-slider" min="0" max="10" step="0.5" value="0" oninput="updateFilter()">
                        </div>
                        <div class="filter-group">
                            <label for="sharpenRange" class="filter-label">üî™ Sharpen: <span id="sharpenValue">0</span>%</label>
                            <input type="range" id="sharpenRange" class="filter-slider" min="0" max="100" value="0" oninput="updateFilter()">
                        </div>
                    </div>
                </div>

                <!-- Filter Presets -->
                <div class="presets-section" id="presetsSection" style="display: none;">
                    <h3 class="section-title">Filter Presets</h3>
                    <div class="preset-grid">
                        <div class="preset-card" onclick="applyPreset('vintage')">
                            <div class="preset-icon">üìª</div>
                            <div class="preset-name">Vintage</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('cinematic')">
                            <div class="preset-icon">üé¨</div>
                            <div class="preset-name">Cinematic</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('highContrast')">
                            <div class="preset-icon">‚ö°</div>
                            <div class="preset-name">High Contrast</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('warm')">
                            <div class="preset-icon">üî•</div>
                            <div class="preset-name">Warm Tone</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('cool')">
                            <div class="preset-icon">‚ùÑÔ∏è</div>
                            <div class="preset-name">Cool Tone</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('vibrant')">
                            <div class="preset-icon">üåà</div>
                            <div class="preset-name">Vibrant</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('blackWhite')">
                            <div class="preset-icon">‚ö´</div>
                            <div class="preset-name">Black & White</div>
                        </div>
                        <div class="preset-card" onclick="applyPreset('reset')">
                            <div class="preset-icon">üîÑ</div>
                            <div class="preset-name">Reset All</div>
                        </div>
                    </div>
                    
                    <!-- Processing Workflow Information -->
                    <div class="workflow-info" style="margin-top: 20px; padding: 16px; background: var(--color-info); color: white; border-radius: var(--radius-card); font-size: 14px;">
                        <strong>‚ÑπÔ∏è How it works:</strong> 
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li>Adjust filters below to see real-time preview</li>
                            <li>Click "Process Video" to generate final filtered output</li>
                            <li>Download your processed video when ready</li>
                        </ul>
                    </div>
                </div>

                <!-- Video Preview Section -->
                <div class="preview-section" id="previewSection" style="display: none;">
                    <h3 class="section-title">Video Preview</h3>
                    <div class="preview-controls">
                        <button class="btn btn-secondary" onclick="toggleComparisonMode()">üîÄ Comparison Mode</button>
                        <button class="btn btn-secondary" onclick="resetFilters()">üîÑ Reset Filters</button>
                        <button class="btn btn-primary" onclick="processVideo()">‚öôÔ∏è Process Video</button>
                    </div>
                    
                    <div class="video-preview-container" id="videoPreview">
                        <!-- Video preview will be shown here -->
                    </div>
                    
                    <div class="progress-section" id="progressSection" style="display: none;">
                        <div class="progress-label">Processing video...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">0%</div>
                    </div>

                    <div class="download-section" id="downloadSection" style="display: none;">
                        <button class="btn btn-primary" onclick="downloadFilteredVideo()">‚¨áÔ∏è Download Filtered Video</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- AdSense Container -->
        <div class="ad-container bottom-ad">
            <!-- AdSense code will be inserted here -->
        </div>

        <!-- Privacy Notice -->
        <section class="privacy-notice">
            <div class="container">
                <div class="privacy-content">
                    <div class="privacy-icon">üîí</div>
                    <div class="privacy-text">
                        <h4>Your Privacy is Protected</h4>
                        <p>All video processing happens in your browser using local algorithms. Your video files never leave your device and are not stored on our servers. We cannot access or view your content.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Related Tools -->
        <section class="related-tools">
            <div class="container">
                <h3 class="related-title">More Video Tools</h3>
                <div class="related-grid">
                    <a href="video_compressor.html" class="related-card">
                        <div class="related-icon">üìπ</div>
                        <div class="related-content">
                            <h4>Video Compressor</h4>
                            <p>Compress video files to reduce size while maintaining quality</p>
                        </div>
                    </a>
                    <a href="audio_extractor.html" class="related-card">
                        <div class="related-icon">üéµ</div>
                        <div class="related-content">
                            <h4>Audio Extractor</h4>
                            <p>Extract audio from video files in various formats</p>
                        </div>
                    </a>
                    <a href="video_converter.html" class="related-card">
                        <div class="related-icon">üîÑ</div>
                        <div class="related-content">
                            <h4>Video Converter</h4>
                            <p>Convert videos between different formats and qualities</p>
                        </div>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Content</h4>
                    <ul>
                        <li><a href="/blog/">All Articles</a></li>
                        <li><a href="/blog/?category=productivity">Productivity</a></li>
                        <li><a href="/blog/?category=technology">Technology</a></li>
                        <li><a href="/blog/?category=business">Business</a></li>
                        <li><a href="/blog/?category=learning">Learning</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Tools</h4>
                    <ul>
                        <li><a href="/tools/">All Tools</a></li>
                        <li><a href="/tools/categories/image.html">Image Tools</a></li>
                        <li><a href="/tools/categories/pdf.html">PDF Tools</a></li>
                        <li><a href="/tools/categories/video.html">Video/Audio Tools</a></li>
                        <li><a href="/tools/categories/text.html">Text Tools</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="/about.html">About</a></li>
                        <li><a href="/contact.html">Contact</a></li>
                        <li><a href="/privacy.html">Privacy Policy</a></li>
                        <li><a href="/terms.html">Terms of Service</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Connect</h4>
                    <ul>
                        <li><a href="mailto:factictionary@gmail.com">Email Us</a></li>
                        <li><a href="/contact.html">Support</a></li>
                        <li><a href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">Back to Top</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Factictionary. All rights reserved. Privacy-first educational platform for the modern web.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Global variables
        let currentVideoFile = null;
        let videoElement = null;
        let originalVideoURL = null;
        let comparisonMode = false;
        let ffmpeg = null;
        let ffmpegLoaded = false;
        let currentFilters = {
            brightness: 0,
            contrast: 0,
            saturation: 0,
            hue: 0,
            sepia: 0,
            grayscale: 0,
            blur: 0,
            sharpen: 0
        };
        let processedVideoBlob = null;

        // File upload handlers
        function handleDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            const uploadArea = document.getElementById('videoUpload');
            uploadArea.classList.remove('drag-over');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.stopPropagation();
        }

        function handleDragEnter(event) {
            event.preventDefault();
            event.stopPropagation();
            const uploadArea = document.getElementById('videoUpload');
            uploadArea.classList.add('drag-over');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            event.stopPropagation();
            const uploadArea = document.getElementById('videoUpload');
            uploadArea.classList.remove('drag-over');
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            // Validate file type
            const validTypes = ['video/mp4', 'video/webm', 'video/avi', 'video/quicktime', 'video/x-msvideo', 'video/x-ms-wmv'];
            if (!validTypes.includes(file.type)) {
                showNotification('Invalid file type. Please select MP4, WebM, AVI, MOV, or WMV video file.', 'error');
                return;
            }

            // Validate file size (500MB limit)
            const maxSize = 500 * 1024 * 1024;
            if (file.size > maxSize) {
                showNotification('File too large. Maximum size is 500MB.', 'error');
                return;
            }

            // Clear any previous processed video
            processedVideoBlob = null;
            
            currentVideoFile = file;
            displayFileInfo(file);
            showVideoPreview(file);
            showFilterControls();
            showNotification('Video loaded successfully! You can now apply filters.', 'success');
        }

        function displayFileInfo(file) {
            const fileInfo = document.getElementById('fileInfo');
            const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
            fileInfo.innerHTML = `
                <div class="file-info-content">
                    <div class="file-name">üìπ ${file.name}</div>
                    <div class="file-details">${sizeMB} MB ‚Ä¢ ${file.type}</div>
                    <button class="btn btn-secondary" onclick="clearVideo()">üóëÔ∏è Remove</button>
                </div>
            `;
            fileInfo.style.display = 'block';
        }

        function showVideoPreview(file) {
            const previewSection = document.getElementById('previewSection');
            const videoPreview = document.getElementById('videoPreview');
            
            // Create object URL for the video
            if (originalVideoURL) {
                URL.revokeObjectURL(originalVideoURL);
            }
            originalVideoURL = URL.createObjectURL(file);
            
            videoPreview.innerHTML = `
                <div class="video-container" id="videoContainer">
                    <video id="videoElement" controls preload="metadata" style="max-width: 100%; height: auto;">
                        <source src="${originalVideoURL}" type="${file.type}">
                        Your browser does not support the video tag.
                    </video>
                </div>
            `;
            
            videoElement = document.getElementById('videoElement');
            videoElement.addEventListener('loadedmetadata', function() {
                previewSection.style.display = 'block';
                // Reset filter values when new video loads
                resetFilterValues();
            });
        }

        function showFilterControls() {
            document.getElementById('filterSection').style.display = 'block';
            document.getElementById('presetsSection').style.display = 'block';
        }

        function clearVideo() {
            currentVideoFile = null;
            if (originalVideoURL) {
                URL.revokeObjectURL(originalVideoURL);
                originalVideoURL = null;
            }
            
            // Clear processed video
            processedVideoBlob = null;
            
            // Reset file input
            document.getElementById('videoFileInput').value = '';
            
            // Hide all sections
            document.getElementById('fileInfo').style.display = 'none';
            document.getElementById('filterSection').style.display = 'none';
            document.getElementById('presetsSection').style.display = 'none';
            document.getElementById('previewSection').style.display = 'none';
            
            showNotification('Video removed. Upload a new video to continue.', 'info');
        }

        // Filter control handlers
        function updateFilter() {
            if (!videoElement) return;

            // Get current values
            currentFilters.brightness = document.getElementById('brightnessRange').value;
            currentFilters.contrast = document.getElementById('contrastRange').value;
            currentFilters.saturation = document.getElementById('saturationRange').value;
            currentFilters.hue = document.getElementById('hueRange').value;
            currentFilters.sepia = document.getElementById('sepiaRange').value;
            currentFilters.grayscale = document.getElementById('grayscaleRange').value;
            currentFilters.blur = document.getElementById('blurRange').value;
            currentFilters.sharpen = document.getElementById('sharpenRange').value;

            // Update display values
            document.getElementById('brightnessValue').textContent = currentFilters.brightness;
            document.getElementById('contrastValue').textContent = currentFilters.contrast;
            document.getElementById('saturationValue').textContent = currentFilters.saturation;
            document.getElementById('hueValue').textContent = currentFilters.hue;
            document.getElementById('sepiaValue').textContent = currentFilters.sepia;
            document.getElementById('grayscaleValue').textContent = currentFilters.grayscale;
            document.getElementById('blurValue').textContent = currentFilters.blur;
            document.getElementById('sharpenValue').textContent = currentFilters.sharpen;

            // Apply filter to video
            applyFilterToVideo();
        }

        function applyFilterToVideo() {
            if (!videoElement) return;

            const brightness = parseInt(currentFilters.brightness) + 100; // Convert to percentage
            const contrast = parseInt(currentFilters.contrast) + 100;
            const saturation = parseInt(currentFilters.saturation) + 100;
            const hue = parseInt(currentFilters.hue) + 0;
            const sepia = parseInt(currentFilters.sepia);
            const grayscale = parseInt(currentFilters.grayscale);
            const blur = parseFloat(currentFilters.blur);

            // Apply CSS filters for real-time preview
            // Note: This provides visual preview only. Actual processing uses FFmpeg for final output
            const filterString = `
                brightness(${brightness}%)
                contrast(${contrast}%)
                saturate(${saturation}%)
                hue-rotate(${hue}deg)
                sepia(${sepia}%)
                grayscale(${grayscale}%)
                blur(${blur}px)
            `;
            
            const videoContainer = document.getElementById('videoContainer');
            if (videoContainer) {
                videoContainer.style.filter = filterString;
            }
            
            // Clear processed video when filters change
            if (processedVideoBlob) {
                processedVideoBlob = null;
                document.getElementById('downloadSection').style.display = 'none';
                showNotification('Filters changed. Click "Process Video" to generate new output.', 'info');
            }
        }

        // Preset filters
        function applyPreset(presetName) {
            switch(presetName) {
                case 'vintage':
                    setFilters({brightness: 10, contrast: 20, saturation: -30, sepia: 80});
                    break;
                case 'cinematic':
                    setFilters({brightness: -5, contrast: 30, saturation: -10, sepia: 20, hue: -10});
                    break;
                case 'highContrast':
                    setFilters({brightness: 0, contrast: 80, saturation: 0});
                    break;
                case 'warm':
                    setFilters({brightness: 15, contrast: 10, saturation: 20, hue: 10});
                    break;
                case 'cool':
                    setFilters({brightness: 0, contrast: 10, saturation: -10, hue: -30});
                    break;
                case 'vibrant':
                    setFilters({brightness: 5, contrast: 15, saturation: 50});
                    break;
                case 'blackWhite':
                    setFilters({brightness: 0, contrast: 20, saturation: -100, grayscale: 100});
                    break;
                case 'reset':
                    resetFilters();
                    return;
            }
            showNotification(`${presetName.charAt(0).toUpperCase() + presetName.slice(1)} filter applied! Click "Process Video" to generate the filtered output.`, 'success');
        }

        function setFilters(filters) {
            Object.keys(filters).forEach(key => {
                if (document.getElementById(key + 'Range')) {
                    document.getElementById(key + 'Range').value = filters[key];
                    currentFilters[key] = filters[key];
                }
            });
            updateFilter();
        }

        function resetFilters() {
            const defaultFilters = {brightness: 0, contrast: 0, saturation: 0, hue: 0, sepia: 0, grayscale: 0, blur: 0, sharpen: 0};
            setFilters(defaultFilters);
            showNotification('All filters reset to default values.', 'info');
        }

        function resetFilterValues() {
            const defaultFilters = {brightness: 0, contrast: 0, saturation: 0, hue: 0, sepia: 0, grayscale: 0, blur: 0, sharpen: 0};
            Object.keys(defaultFilters).forEach(key => {
                if (document.getElementById(key + 'Range')) {
                    document.getElementById(key + 'Range').value = defaultFilters[key];
                }
            });
            updateFilter();
        }

        function toggleComparisonMode() {
            comparisonMode = !comparisonMode;
            const button = event.target;
            if (comparisonMode) {
                button.textContent = 'üëÅÔ∏è Normal Mode';
                button.classList.remove('btn-secondary');
                button.classList.add('btn-primary');
                // Implement comparison view
                showNotification('üîÄ Comparison mode enabled - showing before/after view');
            } else {
                button.textContent = 'üîÄ Comparison Mode';
                button.classList.remove('btn-primary');
                button.classList.add('btn-secondary');
                showNotification('üëÅÔ∏è Normal mode enabled');
            }
        }

        // Check if FFmpeg scripts are loaded
        function checkFFmpegLoaded() {
            return typeof FFmpegWASM !== 'undefined';
        }

        // Initialize FFmpeg with compatibility check
        async function initializeFFmpeg() {
            if (ffmpegLoaded) return;
            
            // Check if FFmpeg scripts are available
            if (!checkFFmpegLoaded()) {
                throw new Error('FFmpeg.wasm scripts not loaded. Please refresh the page.');
            }
            
            try {
                // Check for WebAssembly support
                if (typeof WebAssembly === 'undefined') {
                    throw new Error('WebAssembly is not supported in this browser');
                }
                
                showNotification('Loading FFmpeg.wasm (this may take a moment)...', 'info');
                
                const { FFmpeg } = FFmpegWASM;
                ffmpeg = new FFmpeg();
                
                ffmpeg.on('log', ({ message }) => {
                    console.log('FFmpeg:', message);
                });
                
                ffmpeg.on('progress', ({ progress }) => {
                    updateProcessingProgress(progress * 100);
                });
                
                await ffmpeg.load({
                    coreURL: 'https://unpkg.com/@ffmpeg/core@0.12.4/dist/umd/ffmpeg-core.js',
                    wasmURL: 'https://unpkg.com/@ffmpeg/core@0.12.4/dist/umd/ffmpeg-core.wasm',
                });
                
                ffmpegLoaded = true;
                showNotification('Video processing engine ready!', 'success');
            } catch (error) {
                console.error('Error loading FFmpeg:', error);
                
                let errorMessage = 'Failed to load video processing engine';
                if (error.message.includes('WebAssembly')) {
                    errorMessage = 'Your browser does not support video processing. Please use a modern browser like Chrome, Firefox, or Safari.';
                } else if (error.message.includes('fetch')) {
                    errorMessage = 'Network error while loading video processor. Please check your internet connection.';
                } else if (error.message.includes('memory')) {
                    errorMessage = 'Insufficient memory to process video. Try a smaller file or close other browser tabs.';
                } else if (error.message.includes('not loaded')) {
                    errorMessage = 'Video processing engine failed to load. Please refresh the page and try again.';
                }
                
                showNotification(errorMessage, 'error');
                throw error;
            }
        }

        // Video processing with FFmpeg
        async function processVideo() {
            if (!currentVideoFile) {
                showNotification('‚ùå Please upload a video first');
                return;
            }

            try {
                // Show progress section
                const progressSection = document.getElementById('progressSection');
                const downloadSection = document.getElementById('downloadSection');
                progressSection.style.display = 'block';
                downloadSection.style.display = 'none';
                
                // Reset progress
                updateProcessingProgress(0);

                // Initialize FFmpeg if not already loaded
                if (!ffmpegLoaded) {
                    await initializeFFmpeg();
                }

                showNotification('‚öôÔ∏è Processing video with filters...');

                // Read the video file
                const videoData = await currentVideoFile.arrayBuffer();
                const inputFileName = 'input.' + getFileExtension(currentVideoFile.name);
                const outputFileName = 'output.mp4';

                // Write input file to FFmpeg file system
                await ffmpeg.writeFile(inputFileName, new Uint8Array(videoData));

                // Build FFmpeg filter command
                const filterCommand = buildFFmpegFilter();
                
                // Execute FFmpeg command
                await ffmpeg.exec([
                    '-i', inputFileName,
                    '-vf', filterCommand,
                    '-c:a', 'copy', // Copy audio without re-encoding
                    '-c:v', 'libx264', // Use H.264 codec
                    '-crf', '23', // Good quality
                    '-preset', 'medium', // Balance between speed and quality
                    outputFileName
                ]);

                // Read the output file
                const outputData = await ffmpeg.readFile(outputFileName);
                
                // Create blob and URL for download
                processedVideoBlob = new Blob([outputData], { type: 'video/mp4' });
                
                // Clean up FFmpeg file system
                await ffmpeg.deleteFile(inputFileName);
                await ffmpeg.deleteFile(outputFileName);

                // Show success
                progressSection.style.display = 'none';
                downloadSection.style.display = 'block';
                showNotification('‚úÖ Video processing complete!');

            } catch (error) {
                console.error('Video processing error:', error);
                showNotification('‚ùå Video processing failed: ' + error.message);
                
                // Hide progress section on error
                const progressSection = document.getElementById('progressSection');
                progressSection.style.display = 'none';
            }
        }

        // Build FFmpeg filter command from current filter values
        function buildFFmpegFilter() {
            const filters = [];
            
            // Brightness/contrast
            if (currentFilters.brightness !== 0 || currentFilters.contrast !== 0) {
                const brightness = (parseInt(currentFilters.brightness) + 100) / 100;
                const contrast = (parseInt(currentFilters.contrast) + 100) / 100;
                filters.push(`eq=brightness=${brightness}:contrast=${contrast}`);
            }
            
            // Saturation
            if (currentFilters.saturation !== 0) {
                const saturation = (parseInt(currentFilters.saturation) + 100) / 100;
                filters.push(`eq=saturation=${saturation}`);
            }
            
            // Hue rotation
            if (currentFilters.hue !== 0) {
                const hue = parseInt(currentFilters.hue);
                filters.push(`hue=h=${hue}*PI/180`);
            }
            
            // Sepia
            if (currentFilters.sepia > 0) {
                const sepia = parseInt(currentFilters.sepia) / 100;
                filters.push(`colorchannelmixer=.393:.769:.189:0:.349:.686:.168:0:.272:.534:.131:0:.393:.769:.189:0:.349:.686:.168:0:.272:.534:.131`);
            }
            
            // Grayscale
            if (currentFilters.grayscale > 0) {
                const gray = parseInt(currentFilters.grayscale) / 100;
                filters.push(`colorchannelmixer=.299:.587:.114:0:.299:.587:.114:0:.299:.587:.114:0:0:0:0:1:0`);
            }
            
            // Blur
            if (currentFilters.blur > 0) {
                const blur = parseFloat(currentFilters.blur);
                filters.push(`gblur=sigma=${blur}`);
            }
            
            // Sharpen
            if (currentFilters.sharpen > 0) {
                const sharpen = parseInt(currentFilters.sharpen) / 100;
                filters.push(`unsharp=5:5:${sharpen}:5:5:0`);
            }
            
            return filters.join(',');
        }

        // Update processing progress
        function updateProcessingProgress(progress) {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            if (progressFill && progressText) {
                progressFill.style.width = Math.min(progress, 100) + '%';
                progressText.textContent = Math.floor(Math.min(progress, 100)) + '%';
            }
        }

        // Download processed video
        function downloadFilteredVideo() {
            if (!processedVideoBlob) {
                showNotification('‚ùå No processed video available');
                return;
            }

            try {
                const url = URL.createObjectURL(processedVideoBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'filtered_' + currentVideoFile.name.replace(/\.[^/.]+$/, '') + '.mp4';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showNotification('‚¨áÔ∏è Video download started');
            } catch (error) {
                console.error('Download error:', error);
                showNotification('‚ùå Download failed: ' + error.message);
            }
        }

        // Utility function to get file extension
        function getFileExtension(filename) {
            return filename.split('.').pop().toLowerCase();
        }

        function showNotification(message, type = 'success') {
            // Create and show a temporary notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            // Set background color based on type
            let bgColor;
            switch (type) {
                case 'error':
                    bgColor = 'var(--color-error)';
                    break;
                case 'warning':
                    bgColor = 'var(--color-warning)';
                    break;
                case 'info':
                    bgColor = 'var(--color-info)';
                    break;
                default:
                    bgColor = 'var(--color-success)';
            }
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 12px 20px;
                border-radius: var(--radius-button);
                font-weight: 500;
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
                max-width: 350px;
                word-wrap: break-word;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Mobile menu functionality
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelector('.nav-links');
        
        menuToggle.addEventListener('click', () => {
            const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
            menuToggle.setAttribute('aria-expanded', !isExpanded);
            navLinks.classList.toggle('active');
        });

        // Add CSS animations for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Cleanup function for page unload
        window.addEventListener('beforeunload', () => {
            // Clean up object URLs
            if (originalVideoURL) {
                URL.revokeObjectURL(originalVideoURL);
            }
            
            // Clean up FFmpeg if loaded
            if (ffmpeg && ffmpegLoaded) {
                // Note: FFmpeg.wasm doesn't have explicit cleanup API
                // The garbage collector will handle memory cleanup
            }
        });

        // Handle page visibility change to pause video when tab is not active
        document.addEventListener('visibilitychange', () => {
            if (videoElement) {
                if (document.hidden) {
                    videoElement.pause();
                }
            }
        });
    </script>

    <style>
        /* Video upload area styles */
        .video-upload-area {
            border: 2px dashed var(--color-neutral-300);
            border-radius: var(--radius-card);
            padding: 60px 40px;
            text-align: center;
            background: var(--color-neutral-50);
            transition: all var(--duration-fast);
            cursor: pointer;
        }

        .video-upload-area:hover,
        .video-upload-area.drag-over {
            border-color: var(--color-primary-500);
            background: var(--color-primary-50);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.2);
        }

        .video-upload-area.drag-over {
            border-color: var(--color-primary-600);
            background: var(--color-primary-100);
        }

        .upload-content h3 {
            font-size: var(--font-size-subtitle);
            color: var(--color-neutral-700);
            margin: 16px 0 8px 0;
        }

        .upload-content p {
            color: var(--color-neutral-600);
            margin-bottom: 20px;
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }

        .file-info {
            background: var(--color-surface);
            border: 1px solid var(--color-neutral-200);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
            margin-top: var(--spacing-md);
        }

        .file-info-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .file-name {
            font-weight: var(--font-weight-medium);
            color: var(--color-neutral-900);
        }

        .file-details {
            color: var(--color-neutral-600);
            font-size: var(--font-size-small);
        }

        /* Filter controls */
        .filter-section {
            background: var(--color-surface);
            border: 1px solid var(--color-neutral-200);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .filter-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
        }

        .filter-group {
            background: var(--color-neutral-50);
            padding: var(--spacing-md);
            border-radius: var(--radius-card);
        }

        .filter-label {
            display: block;
            font-weight: var(--font-weight-medium);
            color: var(--color-neutral-700);
            margin-bottom: var(--spacing-sm);
            font-size: var(--font-size-body);
        }

        .filter-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--color-neutral-200);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .filter-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-primary-500);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .filter-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--color-primary-500);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        /* Filter presets */
        .presets-section {
            background: var(--color-surface);
            border: 1px solid var(--color-neutral-200);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--spacing-md);
        }

        .preset-card {
            background: var(--color-neutral-50);
            border: 2px solid transparent;
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
            text-align: center;
            cursor: pointer;
            transition: all var(--duration-fast);
        }

        .preset-card:hover {
            border-color: var(--color-primary-200);
            background: var(--color-primary-50);
            transform: translateY(-2px);
        }

        .preset-icon {
            font-size: 2rem;
            margin-bottom: var(--spacing-sm);
        }

        .preset-name {
            font-weight: var(--font-weight-medium);
            color: var(--color-neutral-700);
            font-size: var(--font-size-small);
        }

        /* Video preview */
        .preview-section {
            background: var(--color-surface);
            border: 1px solid var(--color-neutral-200);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
        }

        .preview-controls {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
        }

        .video-container {
            background: var(--color-neutral-900);
            border-radius: var(--radius-card);
            padding: var(--spacing-md);
            text-align: center;
            margin-bottom: var(--spacing-lg);
        }

        .video-container video {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-input);
        }

        /* Progress indicator */
        .progress-section {
            background: var(--color-neutral-50);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
            text-align: center;
        }

        .progress-label {
            font-weight: var(--font-weight-medium);
            color: var(--color-neutral-700);
            margin-bottom: var(--spacing-md);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--color-neutral-200);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: var(--spacing-sm);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            font-weight: var(--font-weight-medium);
            color: var(--color-primary-600);
        }

        /* Download section */
        .download-section {
            text-align: center;
            margin-top: var(--spacing-lg);
        }

        /* Privacy notice */
        .privacy-notice {
            background: var(--color-primary-50);
            border-top: 1px solid var(--color-primary-100);
            border-bottom: 1px solid var(--color-primary-100);
            padding: var(--spacing-xl) 0;
        }

        .privacy-content {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            background: var(--color-surface);
            border: 1px solid var(--color-primary-200);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
        }

        .privacy-icon {
            font-size: 3rem;
            flex-shrink: 0;
        }

        .privacy-text h4 {
            font-size: var(--font-size-subtitle);
            font-weight: var(--font-weight-semibold);
            color: var(--color-primary-700);
            margin-bottom: var(--spacing-sm);
        }

        .privacy-text p {
            color: var(--color-primary-600);
            margin: 0;
        }

        /* Related tools */
        .related-tools {
            padding: var(--spacing-3xl) 0;
            background: var(--color-neutral-50);
        }

        .related-title {
            font-size: var(--font-size-subtitle);
            font-weight: var(--font-weight-semibold);
            color: var(--color-neutral-900);
            margin-bottom: var(--spacing-xl);
            text-align: center;
        }

        .related-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
        }

        .related-card {
            background: var(--color-surface);
            border: 1px solid var(--color-neutral-200);
            border-radius: var(--radius-card);
            padding: var(--spacing-lg);
            text-decoration: none;
            transition: all var(--duration-standard) var(--easing-standard);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .related-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card-hover);
            border-color: var(--color-primary-100);
        }

        .related-icon {
            font-size: 2em;
            flex-shrink: 0;
        }

        .related-content h4 {
            font-size: var(--font-size-body-large);
            font-weight: var(--font-weight-semibold);
            color: var(--color-neutral-900);
            margin-bottom: var(--spacing-xs);
        }

        .related-content p {
            color: var(--color-neutral-700);
            font-size: var(--font-size-body);
            margin: 0;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .filter-controls {
                grid-template-columns: 1fr;
            }
            
            .preset-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .preview-controls {
                flex-direction: column;
            }
            
            .privacy-content {
                flex-direction: column;
                text-align: center;
            }
            
            .file-info-content {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        /* Loading states */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-card);
            z-index: 10;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced error states */
        .error-message {
            background: var(--color-error);
            color: white;
            padding: var(--spacing-md);
            border-radius: var(--radius-card);
            margin: var(--spacing-md) 0;
            text-align: center;
        }

        /* Workflow info */
        .workflow-info {
            border-left: 4px solid var(--color-primary-400);
        }

        .workflow-info ul {
            list-style-type: disc;
        }
        }

        @media (max-width: 480px) {
            .video-upload-area {
                padding: 40px 20px;
            }
            
            .preset-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>