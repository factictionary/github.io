<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utility Tools - Factictionary</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --dark: #1e293b;
            --light: #f8fafc;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Common Header Styles */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }

        .logo::before {
            content: 'üìö';
        }

        .logo-text h1 {
            font-size: 1.5em;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.75em;
            color: #64748b;
        }

        .nav-links {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            position: relative;
            padding: 5px 0;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s;
        }

        .nav-links a:hover::after, .nav-links a.active::after {
            width: 100%;
        }

        .mobile-menu-btn {
            display: none;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--dark);
        }

        /* Page Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }

        .page-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .page-header h2 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .tool-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }

        .tool-card:hover::before {
            left: 100%;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .tool-card.active {
            border: 3px solid #667eea;
        }

        .tool-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .tool-title {
            font-size: 1.2em;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .tool-desc {
            color: #666;
            font-size: 0.9em;
        }

        .workspace {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
        }

        .workspace.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .text-input-area {
            width: 100%;
            min-height: 150px;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            font-family: 'Courier New', monospace;
            resize: vertical;
            margin-bottom: 20px;
            transition: border 0.3s;
        }

        .text-input-area:focus {
            outline: none;
            border-color: var(--primary);
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        input, select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }

        button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        button.secondary {
            background: linear-gradient(135deg, #f1f5f9, #cbd5e1);
            color: #334155;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        .output-area {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            min-height: 100px;
            word-wrap: break-word;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .file-upload-area {
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: border 0.3s;
        }

        .file-upload-area:hover {
            border-color: var(--primary);
        }

        .file-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.05);
        }

        .qr-code-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        #qrCodeCanvas {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 10px;
        }

        .color-preview {
            width: 100%;
            height: 60px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #ddd;
        }

        .contrast-result {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
            text-align: center;
        }

        .pass-good {
            background-color: #d1fae5;
            color: #065f46;
        }

        .pass-warning {
            background-color: #fef3c7;
            color: #92400e;
        }

        .pass-fail {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .password-strength {
            height: 10px;
            border-radius: 5px;
            margin: 10px 0;
            transition: all 0.3s;
        }

        .strength-weak {
            background: linear-gradient(90deg, #ef4444, #f97316);
            width: 25%;
        }

        .strength-medium {
            background: linear-gradient(90deg, #f97316, #eab308);
            width: 50%;
        }

        .strength-strong {
            background: linear-gradient(90deg, #eab308, #22c55e);
            width: 75%;
        }

        .strength-very-strong {
            background: linear-gradient(90deg, #22c55e, #16a34a);
            width: 100%;
        }

        .converter-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
        }

        .converter-input {
            flex: 1;
        }

        .converter-unit {
            width: 120px;
        }

        .hash-result {
            font-family: monospace;
            word-break: break-all;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                flex-direction: column;
                padding: 20px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            }

            .nav-links.active {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .tools-grid {
                grid-template-columns: 1fr;
            }

            .converter-row {
                flex-direction: column;
                align-items: stretch;
            }

            .converter-unit {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Common Header -->
    <header>
        <div class="header-content">
            <a href="index.html" class="logo-container">
                <div class="logo"></div>
                <div class="logo-text">
                    <h1>Factictionary</h1>
                    <p>Learn ‚Ä¢ Play ‚Ä¢ Create</p>
                </div>
            </a>
            <nav class="nav-links" id="navLinks">
                <a href="index.html">Home</a>
                <a href="video.html">Video</a>
                <a href="image.html">Image</a>
                <a href="text.html">Text</a>
                <a href="pdf.html">PDF</a>
                <a href="audio.html">Audio</a>
                <a href="utilities.html" class="active">Utilities</a>
            </nav>
            <div class="mobile-menu-btn" onclick="toggleMenu()">‚ò∞</div>
        </div>
    </header>

    <div class="container">
        <div class="page-header">
            <h2>üîß Utility Tools</h2>
            <p>Essential utilities for developers and everyday tasks</p>
        </div>

        <div class="tools-grid">
            <div class="tool-card" onclick="selectTool('hash')">
                <div class="tool-icon">üîç</div>
                <h3 class="tool-title">File Hash Checker</h3>
                <p class="tool-desc">Calculate MD5, SHA-1, SHA-256 checksums for file verification</p>
            </div>

            <div class="tool-card" onclick="selectTool('contrast')">
                <div class="tool-icon">üé®</div>
                <h3 class="tool-title">Color Contrast Checker</h3>
                <p class="tool-desc">Check color contrast for web accessibility (WCAG)</p>
            </div>

            <div class="tool-card" onclick="selectTool('qr-generator')">
                <div class="tool-icon">üì±</div>
                <h3 class="tool-title">QR Code Generator</h3>
                <p class="tool-desc">Generate QR codes for URLs, text, Wi-Fi, and more</p>
            </div>

            <div class="tool-card" onclick="selectTool('qr-reader')">
                <div class="tool-icon">üîç</div>
                <h3 class="tool-title">QR Code Reader</h3>
                <p class="tool-desc">Decode QR codes from uploaded images</p>
            </div>

            <div class="tool-card" onclick="selectTool('unit')">
                <div class="tool-icon">üìè</div>
                <h3 class="tool-title">Unit Converter</h3>
                <p class="tool-desc">Convert between length, weight, temperature, data, and more</p>
            </div>

            <div class="tool-card" onclick="selectTool('password')">
                <div class="tool-icon">üîê</div>
                <h3 class="tool-title">Password Generator</h3>
                <p class="tool-desc">Create strong, random passwords with customizable options</p>
            </div>
        </div>

        <div id="workspace" class="workspace">
            <h2 id="workspace-title">Select a tool to get started</h2>
            
            <div id="toolContent">
                <!-- Content will be dynamically loaded here -->
            </div>
            
            <div class="action-buttons" id="actionButtons" style="display: none;"></div>
        </div>
    </div>

    <script>
        let currentTool = null;

        function toggleMenu() {
            document.getElementById('navLinks').classList.toggle('active');
        }

        function selectTool(tool) {
            currentTool = tool;
            document.querySelectorAll('.tool-card').forEach(card => card.classList.remove('active'));
            event.target.closest('.tool-card').classList.add('active');
            
            document.getElementById('workspace').classList.add('active');
            document.getElementById('workspace-title').textContent = getToolTitle(tool);
            
            setupTool();
        }

        function getToolTitle(tool) {
            const titles = {
                'hash': 'File Hash Checker',
                'contrast': 'Color Contrast Checker',
                'qr-generator': 'QR Code Generator',
                'qr-reader': 'QR Code Reader',
                'unit': 'Unit Converter',
                'password': 'Password Generator'
            };
            return titles[tool] || 'Utility Tool';
        }

        function setupTool() {
            const toolContent = document.getElementById('toolContent');
            const actionButtons = document.getElementById('actionButtons');
            
            actionButtons.style.display = 'none';
            
            switch(currentTool) {
                case 'hash':
                    toolContent.innerHTML = `
                        <div class="file-upload-area" id="hashUploadArea">
                            <h3>üìÅ Upload a File</h3>
                            <p>Drag & drop a file here or click to browse</p>
                            <input type="file" id="hashFileInput" style="display: none;" onchange="handleHashFile()">
                        </div>
                        <div class="controls">
                            <div class="control-group">
                                <label>Hash Algorithm</label>
                                <select id="hashAlgorithm">
                                    <option value="md5">MD5</option>
                                    <option value="sha1">SHA-1</option>
                                    <option value="sha256">SHA-256</option>
                                    <option value="sha512">SHA-512</option>
                                </select>
                            </div>
                        </div>
                        <div id="hashResult" class="output-area" style="display: none;"></div>
                    `;
                    setupHashUpload();
                    break;
                    
                case 'contrast':
                    toolContent.innerHTML = `
                        <div class="controls">
                            <div class="control-group">
                                <label>Foreground Color</label>
                                <input type="color" id="fgColor" value="#000000" onchange="updateColorPreview()">
                                <input type="text" id="fgHex" value="#000000" onchange="updateColorFromHex('fg')">
                            </div>
                            <div class="control-group">
                                <label>Background Color</label>
                                <input type="color" id="bgColor" value="#ffffff" onchange="updateColorPreview()">
                                <input type="text" id="bgHex" value="#ffffff" onchange="updateColorFromHex('bg')">
                            </div>
                        </div>
                        <div class="color-preview" id="colorPreview" style="background: linear-gradient(90deg, #000000, #ffffff);"></div>
                        <div id="contrastResult" class="output-area"></div>
                    `;
                    updateContrast();
                    break;
                    
                case 'qr-generator':
                    toolContent.innerHTML = `
                        <div class="controls">
                            <div class="control-group">
                                <label>QR Code Content</label>
                                <textarea id="qrContent" class="text-input-area" placeholder="Enter text, URL, or other content...">https://factictionary.com</textarea>
                            </div>
                            <div class="control-group">
                                <label>QR Code Size</label>
                                <select id="qrSize">
                                    <option value="128">Small (128x128)</option>
                                    <option value="256" selected>Medium (256x256)</option>
                                    <option value="512">Large (512x512)</option>
                                </select>
                            </div>
                            <button onclick="generateQRCode()">Generate QR Code</button>
                        </div>
                        <div class="qr-code-container">
                            <canvas id="qrCodeCanvas"></canvas>
                        </div>
                    `;
                    generateQRCode();
                    break;
                    
                case 'qr-reader':
                    toolContent.innerHTML = `
                        <div class="file-upload-area" id="qrUploadArea">
                            <h3>üìÅ Upload QR Code Image</h3>
                            <p>Drag & drop an image containing a QR code or click to browse</p>
                            <input type="file" id="qrFileInput" style="display: none;" accept="image/*" onchange="handleQRFile()">
                        </div>
                        <div id="qrImageContainer" style="display: none; text-align: center; margin: 20px 0;">
                            <img id="qrImage" style="max-width: 100%; max-height: 300px; border-radius: 10px;">
                        </div>
                        <div id="qrResult" class="output-area" style="display: none;"></div>
                    `;
                    setupQRUpload();
                    break;
                    
                case 'unit':
                    toolContent.innerHTML = `
                        <div class="controls">
                            <div class="control-group">
                                <label>Conversion Type</label>
                                <select id="unitType" onchange="changeUnitType()">
                                    <option value="length">Length</option>
                                    <option value="weight">Weight</option>
                                    <option value="temperature">Temperature</option>
                                    <option value="data">Data</option>
                                    <option value="currency">Currency</option>
                                </select>
                            </div>
                        </div>
                        <div id="unitConverter"></div>
                    `;
                    changeUnitType();
                    break;
                    
                case 'password':
                    toolContent.innerHTML = `
                        <div class="controls">
                            <div class="control-group">
                                <label>Password Length</label>
                                <input type="range" id="passLength" min="8" max="32" value="16" onchange="updatePasswordLength()">
                                <span id="passLengthValue">16</span>
                            </div>
                            <div class="control-group">
                                <label>Include Uppercase</label>
                                <input type="checkbox" id="includeUpper" checked>
                            </div>
                            <div class="control-group">
                                <label>Include Lowercase</label>
                                <input type="checkbox" id="includeLower" checked>
                            </div>
                            <div class="control-group">
                                <label>Include Numbers</label>
                                <input type="checkbox" id="includeNumbers" checked>
                            </div>
                            <div class="control-group">
                                <label>Include Symbols</label>
                                <input type="checkbox" id="includeSymbols" checked>
                            </div>
                            <button onclick="generatePassword()">Generate Password</button>
                        </div>
                        <div id="passwordResult" class="output-area"></div>
                        <div id="passwordStrength" class="password-strength"></div>
                    `;
                    generatePassword();
                    break;
            }
            
            showActionButtons();
        }

        function showActionButtons() {
            const actionButtons = document.getElementById('actionButtons');
            actionButtons.style.display = 'flex';
            actionButtons.innerHTML = `
                <button onclick="copyOutput()">üìã Copy Result</button>
                <button onclick="clearAll()" class="secondary">üóëÔ∏è Clear All</button>
            `;
        }

        // File Hash Checker Functions
        function setupHashUpload() {
            const uploadArea = document.getElementById('hashUploadArea');
            const fileInput = document.getElementById('hashFileInput');
            
            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleHashFile();
                }
            });
        }

        async function handleHashFile() {
            const fileInput = document.getElementById('hashFileInput');
            const algorithm = document.getElementById('hashAlgorithm').value;
            const resultArea = document.getElementById('hashResult');
            
            if (!fileInput.files.length) return;
            
            const file = fileInput.files[0];
            resultArea.style.display = 'block';
            resultArea.innerHTML = `Calculating ${algorithm.toUpperCase()} hash...`;
            
            try {
                const hash = await calculateFileHash(file, algorithm);
                resultArea.innerHTML = `
                    <div><strong>File:</strong> ${file.name}</div>
                    <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                    <div><strong>${algorithm.toUpperCase()}:</strong> <span class="hash-result">${hash}</span></div>
                `;
            } catch (error) {
                resultArea.innerHTML = `Error: ${error.message}`;
            }
        }

        async function calculateFileHash(file, algorithm) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const data = new Uint8Array(e.target.result);
                    
                    crypto.subtle.digest(algorithm.toUpperCase(), data)
                        .then(hashBuffer => {
                            const hashArray = Array.from(new Uint8Array(hashBuffer));
                            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                            resolve(hashHex);
                        })
                        .catch(reject);
                };
                
                reader.onerror = () => reject(new Error('Failed to read file'));
                reader.readAsArrayBuffer(file);
            });
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Color Contrast Checker Functions
        function updateColorPreview() {
            const fgColor = document.getElementById('fgColor').value;
            const bgColor = document.getElementById('bgColor').value;
            const preview = document.getElementById('colorPreview');
            const fgHex = document.getElementById('fgHex');
            const bgHex = document.getElementById('bgHex');
            
            fgHex.value = fgColor;
            bgHex.value = bgColor;
            preview.style.background = `linear-gradient(90deg, ${fgColor}, ${bgColor})`;
            
            updateContrast();
        }

        function updateColorFromHex(type) {
            const colorInput = document.getElementById(`${type}Color`);
            const hexInput = document.getElementById(`${type}Hex`);
            
            // Validate hex color
            const hex = hexInput.value;
            if (/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(hex)) {
                colorInput.value = hex;
                updateColorPreview();
            }
        }

        function updateContrast() {
            const fgColor = document.getElementById('fgColor').value;
            const bgColor = document.getElementById('bgColor').value;
            const resultArea = document.getElementById('contrastResult');
            
            const contrast = getContrastRatio(hexToRgb(fgColor), hexToRgb(bgColor));
            const wcagAA = contrast >= 4.5 ? 'PASS' : 'FAIL';
            const wcagAAA = contrast >= 7 ? 'PASS' : 'FAIL';
            const wcagAALarge = contrast >= 3 ? 'PASS' : 'FAIL';
            
            let contrastClass = 'pass-fail';
            if (contrast >= 7) contrastClass = 'pass-good';
            else if (contrast >= 4.5) contrastClass = 'pass-warning';
            
            resultArea.innerHTML = `
                <div class="contrast-result ${contrastClass}">
                    Contrast Ratio: ${contrast.toFixed(2)}:1
                </div>
                <div><strong>WCAG 2.0 Results:</strong></div>
                <div>AA (Normal Text): <strong>${wcagAA}</strong> (requires 4.5:1)</div>
                <div>AA (Large Text): <strong>${wcagAALarge}</strong> (requires 3:1)</div>
                <div>AAA (Normal Text): <strong>${wcagAAA}</strong> (requires 7:1)</div>
            `;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : {r: 0, g: 0, b: 0};
        }

        function getContrastRatio(color1, color2) {
            const luminance1 = getLuminance(color1);
            const luminance2 = getLuminance(color2);
            const brightest = Math.max(luminance1, luminance2);
            const darkest = Math.min(luminance1, luminance2);
            return (brightest + 0.05) / (darkest + 0.05);
        }

        function getLuminance(color) {
            const r = color.r / 255;
            const g = color.g / 255;
            const b = color.b / 255;
            
            const rs = r <= 0.03928 ? r / 12.92 : Math.pow((r + 0.055) / 1.055, 2.4);
            const gs = g <= 0.03928 ? g / 12.92 : Math.pow((g + 0.055) / 1.055, 2.4);
            const bs = b <= 0.03928 ? b / 12.92 : Math.pow((b + 0.055) / 1.055, 2.4);
            
            return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
        }

        // QR Code Generator Functions
        function generateQRCode() {
            const content = document.getElementById('qrContent').value;
            const size = parseInt(document.getElementById('qrSize').value);
            const canvas = document.getElementById('qrCodeCanvas');
            
            if (!content.trim()) {
                alert('Please enter content for the QR code');
                return;
            }
            
            QRCode.toCanvas(canvas, content, {
                width: size,
                margin: 2,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function(error) {
                if (error) {
                    console.error(error);
                    alert('Error generating QR code: ' + error.message);
                }
            });
        }

        // QR Code Reader Functions
        function setupQRUpload() {
            const uploadArea = document.getElementById('qrUploadArea');
            const fileInput = document.getElementById('qrFileInput');
            
            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleQRFile();
                }
            });
        }

        function handleQRFile() {
            const fileInput = document.getElementById('qrFileInput');
            const imageContainer = document.getElementById('qrImageContainer');
            const qrImage = document.getElementById('qrImage');
            const resultArea = document.getElementById('qrResult');
            
            if (!fileInput.files.length) return;
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                qrImage.src = e.target.result;
                imageContainer.style.display = 'block';
                resultArea.style.display = 'block';
                resultArea.textContent = 'Processing QR code...';
                
                // Decode QR code
                decodeQRCode(e.target.result);
            };
            
            reader.readAsDataURL(file);
        }

        function decodeQRCode(dataUrl) {
            const resultArea = document.getElementById('qrResult');
            const img = new Image();
            
            img.onload = function() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const code = jsQR(imageData.data, imageData.width, imageData.height);
                
                if (code) {
                    resultArea.textContent = code.data;
                } else {
                    resultArea.textContent = 'No QR code found in the image';
                }
            };
            
            img.src = dataUrl;
        }

        // Unit Converter Functions
        function changeUnitType() {
            const type = document.getElementById('unitType').value;
            const converter = document.getElementById('unitConverter');
            
            let html = '';
            
            switch(type) {
                case 'length':
                    html = createUnitConverter('length', 'Meters', 'Feet', 3.28084);
                    break;
                case 'weight':
                    html = createUnitConverter('weight', 'Kilograms', 'Pounds', 2.20462);
                    break;
                case 'temperature':
                    html = createTemperatureConverter();
                    break;
                case 'data':
                    html = createUnitConverter('data', 'Megabytes', 'Gigabytes', 0.001);
                    break;
                case 'currency':
                    html = createCurrencyConverter();
                    break;
            }
            
            converter.innerHTML = html;
        }

        function createUnitConverter(type, unit1, unit2, conversionFactor) {
            return `
                <div class="converter-row">
                    <input type="number" class="converter-input" id="${type}Value1" value="1" oninput="convertUnits('${type}', 1, ${conversionFactor})">
                    <select class="converter-unit" id="${type}Unit1" onchange="convertUnits('${type}', 1, ${conversionFactor})">
                        <option value="1">${unit1}</option>
                        <option value="${conversionFactor}">${unit2}</option>
                    </select>
                </div>
                <div class="converter-row">
                    <input type="number" class="converter-input" id="${type}Value2" value="${conversionFactor}" oninput="convertUnits('${type}', 2, ${conversionFactor})">
                    <select class="converter-unit" id="${type}Unit2" onchange="convertUnits('${type}', 2, ${conversionFactor})">
                        <option value="${conversionFactor}">${unit2}</option>
                        <option value="1">${unit1}</option>
                    </select>
                </div>
            `;
        }

        function createTemperatureConverter() {
            return `
                <div class="converter-row">
                    <input type="number" class="converter-input" id="tempValue1" value="0" oninput="convertTemperature(1)">
                    <select class="converter-unit" id="tempUnit1" onchange="convertTemperature(1)">
                        <option value="celsius">Celsius</option>
                        <option value="fahrenheit">Fahrenheit</option>
                        <option value="kelvin">Kelvin</option>
                    </select>
                </div>
                <div class="converter-row">
                    <input type="number" class="converter-input" id="tempValue2" value="32" oninput="convertTemperature(2)">
                    <select class="converter-unit" id="tempUnit2" onchange="convertTemperature(2)">
                        <option value="fahrenheit">Fahrenheit</option>
                        <option value="celsius">Celsius</option>
                        <option value="kelvin">Kelvin</option>
                    </select>
                </div>
            `;
        }

        function createCurrencyConverter() {
            return `
                <div class="converter-row">
                    <input type="number" class="converter-input" id="currencyValue1" value="1" oninput="convertCurrency(1)">
                    <select class="converter-unit" id="currencyUnit1" onchange="convertCurrency(1)">
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="CAD">CAD</option>
                    </select>
                </div>
                <div class="converter-row">
                    <input type="number" class="converter-input" id="currencyValue2" value="0.85" oninput="convertCurrency(2)">
                    <select class="converter-unit" id="currencyUnit2" onchange="convertCurrency(2)">
                        <option value="EUR">EUR</option>
                        <option value="USD">USD</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="CAD">CAD</option>
                    </select>
                </div>
                <p style="text-align: center; margin-top: 10px; color: #666; font-size: 0.9em;">
                    Note: Currency rates are for demonstration only
                </p>
            `;
        }

        function convertUnits(type, source, conversionFactor) {
            const value1 = parseFloat(document.getElementById(`${type}Value1`).value);
            const value2 = parseFloat(document.getElementById(`${type}Value2`).value);
            const unit1 = parseFloat(document.getElementById(`${type}Unit1`).value);
            const unit2 = parseFloat(document.getElementById(`${type}Unit2`).value);
            
            if (source === 1) {
                const baseValue = value1 / unit1;
                document.getElementById(`${type}Value2`).value = (baseValue * unit2).toFixed(6);
            } else {
                const baseValue = value2 / unit2;
                document.getElementById(`${type}Value1`).value = (baseValue * unit1).toFixed(6);
            }
        }

        function convertTemperature(source) {
            const value1 = parseFloat(document.getElementById('tempValue1').value);
            const value2 = parseFloat(document.getElementById('tempValue2').value);
            const unit1 = document.getElementById('tempUnit1').value;
            const unit2 = document.getElementById('tempUnit2').value;
            
            if (source === 1) {
                // Convert from unit1 to all base units, then to unit2
                let celsius;
                if (unit1 === 'celsius') celsius = value1;
                else if (unit1 === 'fahrenheit') celsius = (value1 - 32) * 5/9;
                else if (unit1 === 'kelvin') celsius = value1 - 273.15;
                
                if (unit2 === 'celsius') document.getElementById('tempValue2').value = celsius.toFixed(2);
                else if (unit2 === 'fahrenheit') document.getElementById('tempValue2').value = (celsius * 9/5 + 32).toFixed(2);
                else if (unit2 === 'kelvin') document.getElementById('tempValue2').value = (celsius + 273.15).toFixed(2);
            } else {
                // Convert from unit2 to all base units, then to unit1
                let celsius;
                if (unit2 === 'celsius') celsius = value2;
                else if (unit2 === 'fahrenheit') celsius = (value2 - 32) * 5/9;
                else if (unit2 === 'kelvin') celsius = value2 - 273.15;
                
                if (unit1 === 'celsius') document.getElementById('tempValue1').value = celsius.toFixed(2);
                else if (unit1 === 'fahrenheit') document.getElementById('tempValue1').value = (celsius * 9/5 + 32).toFixed(2);
                else if (unit1 === 'kelvin') document.getElementById('tempValue1').value = (celsius + 273.15).toFixed(2);
            }
        }

        function convertCurrency(source) {
            // Mock exchange rates for demonstration
            const rates = {
                USD: 1,
                EUR: 0.85,
                GBP: 0.73,
                JPY: 110.25,
                CAD: 1.25
            };
            
            const value1 = parseFloat(document.getElementById('currencyValue1').value);
            const value2 = parseFloat(document.getElementById('currencyValue2').value);
            const unit1 = document.getElementById('currencyUnit1').value;
            const unit2 = document.getElementById('currencyUnit2').value;
            
            if (source === 1) {
                const usdValue = value1 / rates[unit1];
                document.getElementById('currencyValue2').value = (usdValue * rates[unit2]).toFixed(4);
            } else {
                const usdValue = value2 / rates[unit2];
                document.getElementById('currencyValue1').value = (usdValue * rates[unit1]).toFixed(4);
            }
        }

        // Password Generator Functions
        function updatePasswordLength() {
            const length = document.getElementById('passLength').value;
            document.getElementById('passLengthValue').textContent = length;
        }

        function generatePassword() {
            const length = parseInt(document.getElementById('passLength').value);
            const includeUpper = document.getElementById('includeUpper').checked;
            const includeLower = document.getElementById('includeLower').checked;
            const includeNumbers = document.getElementById('includeNumbers').checked;
            const includeSymbols = document.getElementById('includeSymbols').checked;
            
            const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lowercase = 'abcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            let characters = '';
            if (includeUpper) characters += uppercase;
            if (includeLower) characters += lowercase;
            if (includeNumbers) characters += numbers;
            if (includeSymbols) characters += symbols;
            
            if (!characters) {
                alert('Please select at least one character type');
                return;
            }
            
            let password = '';
            for (let i = 0; i < length; i++) {
                password += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            
            document.getElementById('passwordResult').textContent = password;
            updatePasswordStrength(password);
        }

        function updatePasswordStrength(password) {
            const strengthBar = document.getElementById('passwordStrength');
            let strength = 0;
            
            // Length check
            if (password.length >= 8) strength += 1;
            if (password.length >= 12) strength += 1;
            if (password.length >= 16) strength += 1;
            
            // Character variety checks
            if (/[a-z]/.test(password)) strength += 1;
            if (/[A-Z]/.test(password)) strength += 1;
            if (/[0-9]/.test(password)) strength += 1;
            if (/[^a-zA-Z0-9]/.test(password)) strength += 1;
            
            // Update strength bar
            strengthBar.className = 'password-strength';
            if (strength <= 3) {
                strengthBar.classList.add('strength-weak');
            } else if (strength <= 5) {
                strengthBar.classList.add('strength-medium');
            } else if (strength <= 7) {
                strengthBar.classList.add('strength-strong');
            } else {
                strengthBar.classList.add('strength-very-strong');
            }
        }

        // Common Functions
        function copyOutput() {
            let textToCopy = '';
            
            switch(currentTool) {
                case 'hash':
                    const hashResult = document.getElementById('hashResult');
                    if (hashResult.style.display !== 'none') {
                        const hashText = hashResult.querySelector('.hash-result');
                        if (hashText) textToCopy = hashText.textContent;
                    }
                    break;
                case 'contrast':
                    textToCopy = document.getElementById('contrastResult').textContent;
                    break;
                case 'qr-generator':
                    textToCopy = document.getElementById('qrContent').value;
                    break;
                case 'qr-reader':
                    textToCopy = document.getElementById('qrResult').textContent;
                    break;
                case 'password':
                    textToCopy = document.getElementById('passwordResult').textContent;
                    break;
            }
            
            if (textToCopy) {
                navigator.clipboard.writeText(textToCopy);
                alert('‚úÖ Copied to clipboard!');
            } else {
                alert('‚ùå Nothing to copy');
            }
        }

        function clearAll() {
            const textInput = document.getElementById('textInput');
            if (textInput) textInput.value = '';
            
            const outputAreas = document.querySelectorAll('.output-area');
            outputAreas.forEach(area => {
                area.textContent = '';
                area.style.display = 'none';
            });
            
            if (currentTool === 'hash' || currentTool === 'qr-reader') {
                const fileInputs = document.querySelectorAll('input[type="file"]');
                fileInputs.forEach(input => input.value = '');
                
                const imageContainers = document.querySelectorAll('#qrImageContainer, #hashResult');
                imageContainers.forEach(container => container.style.display = 'none');
            }
            
            if (currentTool === 'password') {
                generatePassword();
            }
        }
    </script>
</body>
</html>