<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulary Crossword</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; }
        .crossword-grid { display: grid; grid-template-columns: repeat(5, 40px); grid-gap: 2px; }
        .cell { width: 40px; height: 40px; border: 1px solid #000; text-align: center; font-size: 20px; }
        .cell.black { background-color: #000; }
        .cell input { width: 100%; height: 100%; border: none; text-align: center; font-size: 20px; text-transform: uppercase; }
        .clues { margin-top: 20px; }
        .clues h3 { margin-bottom: 10px; }
        .clues ul { list-style: none; padding: 0; }
        .clues li { margin-bottom: 5px; }
        .controls { margin: 20px 0; }
        .stats { margin-bottom: 20px; }
        .share-buttons { margin: 10px 0; }
        .advertisement { margin-top: 20px; border: 1px solid #ccc; padding: 10px; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/games">‚Üê Back to Games</a>
        <h1>üìù Vocabulary Crossword</h1>
        <div class="share-buttons">
            <button onclick="share('twitter')">üê¶ Share</button>
            <button onclick="share('facebook')">üìò Share</button>
        </div>
        <div class="stats">
            <p>Words Completed: <span id="words-completed">0</span> / <span id="total-words">5</span></p>
        </div>
        <div class="controls">
            <button onclick="checkAnswers()">Check Answers</button>
            <button onclick="generateNewPuzzle()">Generate New Puzzle</button>
        </div>
        <div id="crossword-grid" class="crossword-grid"></div>
        <div class="clues">
            <div class="across">
                <h3>Across</h3>
                <ul id="across-clues"></ul>
            </div>
            <div class="down">
                <h3>Down</h3>
                <ul id="down-clues"></ul>
            </div>
        </div>
        <div class="advertisement">
            Advertisement 300x250
        </div>
    </div>

    <script>
        let wordsData = [];
        let placedWords = [];
        let grid = [];
        let wordCount = 0;
        let totalWords = 5;

        // Fetch vocabulary JSON
        async function loadVocabulary() {
            try {
                const response = await fetch('vocabulary.json');
                const data = await response.json();
                wordsData = data.difficulty; // Assuming single difficulty level for simplicity
                generateNewPuzzle();
            } catch (error) {
                console.error('Error loading vocabulary:', error);
            }
        }

        // Initialize 5x5 grid
        function initializeGrid() {
            grid = Array(5).fill().map(() => Array(5).fill(''));
            placedWords = [];
            wordCount = 0;
            document.getElementById('words-completed').textContent = '0';
            document.getElementById('total-words').textContent = totalWords;
        }

        // Generate new puzzle
        function generateNewPuzzle() {
            initializeGrid();
            const selectedWords = getRandomWords(wordsData, totalWords);
            placeWords(selectedWords);
            renderGrid();
            renderClues();
        }

        // Get random words from vocabulary
        function getRandomWords(data, count) {
            const shuffled = data.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        // Place words in grid
        function placeWords(words) {
            let number = 1;
            words.forEach(wordObj => {
                const word = wordObj.word.toUpperCase();
                if (word.length > 5) return; // Skip words longer than grid
                let placed = false;
                const direction = Math.random() > 0.5 ? 'across' : 'down';
                let row, col;

                // Try random positions until word fits
                for (let attempts = 0; attempts < 100 && !placed; attempts++) {
                    if (direction === 'across') {
                        row = Math.floor(Math.random() * 5);
                        col = Math.floor(Math.random() * (6 - word.length));
                        if (canPlaceWord(word, row, col, direction)) {
                            placeWord(word, row, col, direction, number, wordObj.definition);
                            placed = true;
                            number++;
                        }
                    } else {
                        row = Math.floor(Math.random() * (6 - word.length));
                        col = Math.floor(Math.random() * 5);
                        if (canPlaceWord(word, row, col, direction)) {
                            placeWord(word, row, col, direction, number, wordObj.definition);
                            placed = true;
                            number++;
                        }
                    }
                }
            });
        }

        // Check if word can be placed
        function canPlaceWord(word, row, col, direction) {
            if (direction === 'across') {
                if (col + word.length > 5) return false;
                for (let i = 0; i < word.length; i++) {
                    const cell = grid[row][col + i];
                    if (cell && cell !== word[i]) return false;
                }
            } else {
                if (row + word.length > 5) return false;
                for (let i = 0; i < word.length; i++) {
                    const cell = grid[row + i][col];
                    if (cell && cell !== word[i]) return false;
                }
            }
            return true;
        }

        // Place word in grid
        function placeWord(word, row, col, direction, number, definition) {
            const wordInfo = { word, row, col, direction, number, definition };
            placedWords.push(wordInfo);
            if (direction === 'across') {
                for (let i = 0; i < word.length; i++) {
                    grid[row][col + i] = word[i];
                }
            } else {
                for (let i = 0; i < word.length; i++) {
                    grid[row + i][col] = word[i];
                }
            }
        }

        // Render crossword grid
        function renderGrid() {
            const gridDiv = document.getElementById('crossword-grid');
            gridDiv.innerHTML = '';
            const clueNumbers = new Map();
            placedWords.forEach(word => {
                clueNumbers.set(`${word.row},${word.col}`, word.number);
            });

            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const cellDiv = document.createElement('div');
                    cellDiv.className = 'cell';
                    if (!grid[i][j]) {
                        cellDiv.className += ' black';
                    } else {
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.maxLength = 1;
                        input.dataset.row = i;
                        input.dataset.col = j;
                        input.oninput = () => input.value = input.value.toUpperCase();
                        cellDiv.appendChild(input);
                        const clueNumber = clueNumbers.get(`${i},${j}`);
                        if (clueNumber) {
                            const numberSpan = document.createElement('span');
                            numberSpan.style.position = 'absolute';
                            numberSpan.style.fontSize = '10px';
                            numberSpan.style.top = '2px';
                            numberSpan.style.left = '2px';
                            numberSpan.textContent = clueNumber;
                            cellDiv.appendChild(numberSpan);
                        }
                    }
                    gridDiv.appendChild(cellDiv);
                }
            }
        }

        // Render clues
        function renderClues() {
            const acrossList = document.getElementById('across-clues');
            const downList = document.getElementById('down-clues');
            acrossList.innerHTML = '';
            downList.innerHTML = '';

            placedWords.forEach(word => {
                const li = document.createElement('li');
                li.textContent = `${word.number}. ${word.definition}`;
                if (word.direction === 'across') {
                    acrossList.appendChild(li);
                } else {
                    downList.appendChild(li);
                }
            });
        }

        // Check answers
        function checkAnswers() {
            let completed = 0;
            placedWords.forEach(word => {
                let correct = true;
                if (word.direction === 'across') {
                    for (let i = 0; i < word.word.length; i++) {
                        const input = document.querySelector(`input[data-row="${word.row}"][data-col="${word.col + i}"]`);
                        if (input && input.value.toUpperCase() !== word.word[i]) {
                            correct = false;
                        }
                    }
                } else {
                    for (let i = 0; i < word.word.length; i++) {
                        const input = document.querySelector(`input[data-row="${word.row + i}"][data-col="${word.col}"]`);
                        if (input && input.value.toUpperCase() !== word.word[i]) {
                            correct = false;
                        }
                    }
                }
                if (correct) completed++;
            });
            document.getElementById('words-completed').textContent = completed;
            if (completed === placedWords.length) {
                alert('Congratulations! All words are correct!');
            } else {
                alert(`You have ${completed} out of ${placedWords.length} words correct.`);
            }
        }

        // Share functionality (placeholder)
        function share(platform) {
            const url = window.location.href;
            if (platform === 'twitter') {
                window.open(`https://x.com/share?url=${encodeURIComponent(url)}`, '_blank');
            } else if (platform === 'facebook') {
                window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
            }
        }

        // Load vocabulary and start game
        window.onload = loadVocabulary;
    </script>
</body>
</html>